/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.0.6 - 2014-10-14
 * @link http://github.com/revolunet/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("angular-google-analytics",[]).provider("Analytics",function(){var a,b,c,d,e,f,g=!1,h=!0,i="",j=!1,k="$routeChangeSuccess",l="auto",m=!1,n=!1,o=!1,p=!1,q={allowLinker:!0};this._logs=[],this.setAccount=function(b){return a=b,!0},this.trackPages=function(a){return h=a,!0},this.trackPrefix=function(a){return i=a,!0},this.setDomainName=function(a){return c=a,!0},this.useDisplayFeatures=function(a){return b=!!a,!0},this.useAnalytics=function(a){return j=!!a,!0},this.useEnhancedLinkAttribution=function(a){return n=!!a,!0},this.useCrossDomainLinker=function(a){return p=!!a,!0},this.setCrossLinkDomains=function(a){return f=a,!0},this.setPageEvent=function(a){return k=a,!0},this.setCookieConfig=function(a){return l=a,!0},this.useECommerce=function(a){return m=!!a,!0},this.setRemoveRegExp=function(a){return a instanceof RegExp?(d=a,!0):!1},this.setExperimentId=function(a){return e=a,!0},this.ignoreFirstPageLoad=function(a){o=!!a},this.$get=["$document","$rootScope","$location","$window",function(r,s,t,u){function v(){if(a){u._gaq=[],u._gaq.push(["_setAccount",a]),c&&u._gaq.push(["_setDomainName",c]),n&&u._gaq.push(["_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"]),h&&!o&&u._gaq.push(d?["_trackPageview",x()]:["_trackPageview"]);var e;e=b?("https:"===document.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js":("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",function(){var a=r[0],b=a.createElement("script");b.type="text/javascript",b.async=!0,b.src=e;var c=a.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}(e),g=!0}}function w(){if(!a)return console.warn("No account id set for Analytics.js");if(function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),angular.isArray(a)?a.forEach(function(a){u.ga("create",a.tracker,l,{name:a.name})}):p?(u.ga("create",a,l,q),u.ga("require","linker"),f&&u.ga("linker:autoLink",f)):u.ga("create",a,l),b&&u.ga("require","displayfeatures"),h&&!o&&u.ga("send","pageview",x()),u.ga&&(m&&u.ga("require","ecommerce","ecommerce.js"),n&&u.ga("require","linkid","linkid.js"),e)){var c=document.createElement("script"),d=document.getElementsByTagName("script")[0];c.src="//www.google-analytics.com/cx/api.js?experiment="+e,d.parentNode.insertBefore(c,d)}}var x=function(){var a=t.path();return d?a.replace(d,""):a};this._log=function(){this._logs.push(arguments)},this._trackPage=function(b,c){c=c?c:r[0].title,h&&!j&&u._gaq?(u._gaq.push(["_set","title",c]),u._gaq.push(["_trackPageview",i+b]),this._log("_trackPageview",arguments)):h&&j&&u.ga&&(angular.isArray(a)?a.forEach(function(a){u.ga(a.name+".send","pageview",{page:i+b,title:c})}):u.ga("send","pageview",{page:i+b,title:c}),this._log("pageview",arguments))},this._trackEvent=function(a,b,c,d){!j&&u._gaq?(u._gaq.push(["_trackEvent",a,b,c,d]),this._log("trackEvent",arguments)):u.ga&&(u.ga("send","event",a,b,c,d),this._log("event",arguments))},this._addTrans=function(a,b,c,d,e,f,g,h,i){!j&&u._gaq?(u._gaq.push(["_addTrans",a,b,c,d,e,f,g,h]),this._log("_addTrans",arguments)):u.ga&&(m?(u.ga("ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,tax:d,shipping:e,currency:i||"USD"}),this._log("ecommerce:addTransaction",arguments)):console.warn("ecommerce no set. Use AnalyticsProvider.setECommerce(true);"))},this._addItem=function(a,b,c,d,e,f){!j&&u._gaq?(u._gaq.push(["_addItem",a,b,c,d,e,f]),this._log("_addItem",arguments)):u.ga&&(u.ga("ecommerce:addItem",{id:a,name:c,sku:b,category:d,price:e,quantity:f}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){!j&&u._gaq?(u._gaq.push(["_trackTrans"]),this._log("_trackTrans",arguments)):u.ga&&(u.ga("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){u.ga&&(u.ga("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._send=function(a){u.ga&&(u.ga("send",a),this._log("send",a))},this._set=function(a,b){u.ga&&(u.ga("set",a,b),this._log("set",a,b))},j?w():v();var y=this;return h&&s.$on(k,function(){y._trackPage(x())}),{_logs:y._logs,cookieConfig:l,displayFeatures:b,ecommerce:m,enhancedLinkAttribution:n,getUrl:x,experimentId:e,ignoreFirstPageLoad:o,trackPage:function(a,b){y._trackPage(a,b)},trackEvent:function(a,b,c,d){y._trackEvent(a,b,c,d)},addTrans:function(a,b,c,d,e,f,g,h,i){y._addTrans(a,b,c,d,e,f,g,h,i)},addItem:function(a,b,c,d,e,f){y._addItem(a,b,c,d,e,f)},trackTrans:function(){y._trackTrans()},clearTrans:function(){y._clearTrans()},send:function(a){y._send(a)},set:function(a,b){y._set(a,b)}}}]});